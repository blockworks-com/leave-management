<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="Leave Management Outlook Addin v1.2" Language="1033" Version="1.2.0.0" Manufacturer="Blockworks Software" UpgradeCode="68F1FB8C-6A5A-4BD5-8709-6B4E0AF6D73C">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Upgrade Id="68F1FB8C-6A5A-4BD5-8709-6B4E0AF6D73C">
      <UpgradeVersion Property="OLDVERSIONFOUND" IncludeMinimum="no" Minimum="1.1.0.0" />
    </Upgrade>

    <Feature Id="ProductFeature" Title="Leave Management Outlook Addin" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="COMPANYFOLDER" Name="Blockworks Software">
          <Directory Id="INSTALLFOLDER" Name="Leave Management" />
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder">
        <Directory Id="LeaveManagement" Name="Leave Management">
          <Directory Id="StartMenuDir" Name="Leave Management Outlook Addin"></Directory>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <DirectoryRef Id="StartMenuDir">
      <Component Id="ApplicationShortcut" Guid="DF713EFA-4AF5-4AA4-AF4C-11B2BC707A78">
        <Shortcut Id="ApplicationStartMenuShortcut"
						Name="View Log File"
						Description="Open the log file."
            Target="[logfile.log]"
						WorkingDirectory="LeaveManagementAddin" />
        <RemoveFolder Id="StartMenuDir" On="uninstall" />
        <RemoveFolder Id="LeaveManagement" Directory="LeaveManagement" On="uninstall" />
        <RemoveFolder Id="ProgramMenuFolder" On="uninstall" />
        <RegistryValue Root="HKLM" Key="Software\Blockworks Software\Leave Management Outlook Addin" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="LeaveManagementCommonDll">
        <File Id="FILE_LeaveManagementCommonDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)LeaveManagement.Common.dll" KeyPath="yes" />
      </Component>

      <Component Id="AddinDll">
        <File Id="FILE_AddinDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetPath)" KeyPath="yes" />
      </Component>
      <Component Id="AddinConfig">
        <File Id="FILE_AddinConfig" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetPath).config" KeyPath="yes" />
      </Component>
      <Component Id="AddinManifest">
        <File Id="FILE_AddinManifest" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetPath).manifest" KeyPath="yes" />
      </Component>

      <!--<Component Id="AddinFeatureToggle">
        <File Id="FILE_AddInFeatureToggle" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)FeatureToggle.Core.dll" KeyPath="yes" />
      </Component>
      <Component Id="AddinUserContext">
        <File Id="FILE_AddInUserContext" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)LeaveManagement.UserContext.dll" KeyPath="yes" />
      </Component>
      <Component Id="AddinUserContextAD">
        <File Id="FILE_AddInUserContextAD" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)LeaveManagement.UserContext.ActiveDirectory.dll" KeyPath="yes" />
      </Component>-->

      <!--<Component Id="AddinRepository">
        <File Id="FILE_AddInRepository" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)LeaveManagement.Repository.dll" KeyPath="yes" />
      </Component>
      <Component Id="AddinModel">
        <File Id="FILE_AddInModel" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)LeaveManagement.Model.dll" KeyPath="yes" />
      </Component>-->

      <!--<Component Id="ManifestFile">
        <File Id="FILE_Manifest" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Manifest.xml" KeyPath="yes" />
      </Component>-->
      <Component Id="AddinVstoManifest">
        <File Id="FILE_AddinVstoManifest" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)$(var.LeaveManagement.OutlookAddIn2010.TargetName).vsto" KeyPath="yes" />
        <RegistryKey Root="HKMR" Key="Software\Microsoft\Office\Outlook\Addins\Blockworks Leave Management Outlook 2010 Add-in">
          <RegistryValue Name="Description" Value="Blockworks Leave Management Outlook 2010 Addin" Type="string" Action="write" />
          <RegistryValue Name="FriendlyName" Value="Blockworks Leave Management Outlook 2010" Type="string" Action="write" />
          <RegistryValue Name="LoadBehavior" Value="3" Type="integer" Action="write" />
          <RegistryValue Name="Manifest" Value="[#FILE_AddinVstoManifest]|vstolocal" Type="string" Action="write" />
        </RegistryKey>
      </Component>

      <Component Id="ToolsCommonUtilitiesDll">
        <File Id="FILE_ToolsCommonUtilitiesDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Common.v4.0.Utilities.dll" KeyPath="yes" />
      </Component>
      <Component Id="ToolsCommonUtilitiesXml">
        <File Id="FILE_ToolsCommonUtilitiesXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Common.v4.0.Utilities.xml" KeyPath="yes" />
      </Component>
      <Component Id="ToolsOutlookUtilitiesDll">
        <File Id="FILE_ToolsOutlookUtilitiesDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Outlook.v4.0.Utilities.dll" KeyPath="yes" />
      </Component>
      <Component Id="ToolsOutlookUtilitiesXml">
        <File Id="FILE_ToolsOutlookUtilitiesXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Outlook.v4.0.Utilities.xml" KeyPath="yes" />
      </Component>
      <Component Id="OfficeToolsOutlookDll">
        <File Id="FILE_OfficeToolsOutlookDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Outlook.dll" KeyPath="yes" />
      </Component>
      <Component Id="OfficeToolsOutlookXml">
        <File Id="FILE_OfficeToolsOutlookXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.Outlook.xml" KeyPath="yes" />
      </Component>
      <Component Id="OfficeToolsDll">
        <File Id="FILE_OfficeToolsDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.v4.0.Framework.dll" KeyPath="yes" />
      </Component>
      <Component Id="OfficeToolsXml">
        <File Id="FILE_OfficeToolsXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.Office.Tools.v4.0.Framework.xml" KeyPath="yes" />
      </Component>
      <Component Id="VSToolsRuntimeDll">
        <File Id="FILE_VSToolsRuntimeDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.VisualStudio.Tools.Applications.Runtime.dll" KeyPath="yes" />
      </Component>
      <Component Id="VSToolsRuntimeXml">
        <File Id="FILE_VSToolsRuntimeXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Microsoft.VisualStudio.Tools.Applications.Runtime.xml" KeyPath="yes" />
      </Component>
      <Component Id="NLogConfig">
        <File Id="FILE_NLogConfig" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)NLog.config" KeyPath="yes" />
      </Component>
      <Component Id="NLogDll">
        <File Id="FILE_NLogDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)NLog.dll" KeyPath="yes" />
      </Component>
      <Component Id="NLogXml">
        <File Id="FILE_NLogXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)NLog.xml" KeyPath="yes" />
      </Component>
      <Component Id="DeltaCompressionDotNetDll">
        <File Id="FILE_DeltaCompressionDotNetDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)DeltaCompressionDotNet.dll" KeyPath="yes" />
      </Component>
      <Component Id="DeltaCompressionDotNet.MsDeltaDll">
        <File Id="FILE_DeltaCompressionDotNet.MsDeltaDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)DeltaCompressionDotNet.MsDelta.dll" KeyPath="yes" />
      </Component>
      <Component Id="DeltaCompressionDotNet.PatchApiDll">
        <File Id="FILE_DeltaCompressionDotNet.PatchApiDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)DeltaCompressionDotNet.PatchApi.dll" KeyPath="yes" />
      </Component>
      <Component Id="ICSharpCode.SharpZipLibDll">
        <File Id="FILE_ICSharpCode.SharpZipLibDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)ICSharpCode.SharpZipLib.dll" KeyPath="yes" />
      </Component>
      <Component Id="ICSharpCode.SharpZipLibXml">
        <File Id="FILE_ICSharpCode.SharpZipLibXml" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)ICSharpCode.SharpZipLib.xml" KeyPath="yes" />
      </Component>
      <Component Id="Mono.CecilDll">
        <File Id="FILE_Mono.CecilDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Mono.Cecil.dll" KeyPath="yes" />
      </Component>
      <Component Id="Mono.Cecil.MdbDll">
        <File Id="FILE_Mono.Cecil.MdbDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Mono.Cecil.Mdb.dll" KeyPath="yes" />
      </Component>
      <Component Id="Mono.Cecil.PdbDll">
        <File Id="FILE_Mono.Cecil.PdbDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Mono.Cecil.Pdb.dll" KeyPath="yes" />
      </Component>
      <Component Id="Mono.Cecil.RocksDll">
        <File Id="FILE_Mono.Cecil.RocksDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Mono.Cecil.Rocks.dll" KeyPath="yes" />
      </Component>
      <Component Id="SplatDll">
        <File Id="FILE_SplatDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Splat.dll" KeyPath="yes" />
      </Component>
      <Component Id="SquirrelDll">
        <File Id="FILE_SquirrelDll" Source="$(var.LeaveManagement.OutlookAddIn2010.TargetDir)Squirrel.dll" KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>